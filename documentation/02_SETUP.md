# Установка и запуск MCP сервера

## Требования

- Java 17+
- Платформа 1С Предприятие (для загрузки данных API)

## Сборка проекта

```bash
./gradlew build
```

## Запуск MCP сервера

### Базовый запуск

```bash
java -jar build/libs/mcp-bsl-context.jar --platform-path /path/to/1c/platform
```

### Использование переменных окружения

Вместо передачи параметра `--platform-path` можно задать переменную окружения:
- `PLATFORM_CONTEXT_PATH` — путь к каталогу установки 1С Предприятия (аналогично `--platform-path`)

Для управления логированием можно задать переменную окружения:
- `LOG_FILE` — путь к файлу для логов сервера (по умолчанию `mcp-server.log` в рабочей директории)

Пример запуска с переменными окружения:

```bash
PLATFORM_CONTEXT_PATH="/opt/1cv8/x86_64/8.3.25.1257" LOG_FILE="/tmp/mcp-server.log" \
  java -jar build/libs/mcp-bsl-context.jar
```

### Параметры запуска

- `--platform-path` - путь к каталогу установки 1С Предприятия
- `--verbose` - включить отладочное логирование
- `--help` - показать справку

### Пример запуска с отладкой

```bash
java -jar build/libs/mcp-bsl-context.jar \
  --platform-path "/opt/1cv8/x86_64/8.3.25.1257" \
  --verbose
```

## Логирование

- **Рабочие логи** - `mcp-server.log` (автоматическая ротация)
- **Отладочные сообщения** - stderr (не мешает MCP протоколу)
- **JSON-RPC коммуникация** - через stdout/stdin

## Устранение неполадок

### Сервер не запускается
1. Проверьте корректность пути к платформе 1С
2. Убедитесь что Java 17+ установлена
3. Проверьте логи в `mcp-server.log`

### MCP клиент не видит tools
1. Убедитесь что сервер полностью загрузился
2. Проверьте совместимость версий MCP протокола
3. Включите отладочное логирование (`--verbose`)

### Медленный поиск
1. Поиск индексируется при запуске - дождитесь завершения
2. При большом объеме данных увеличьте heap size JVM
3. Результаты кэшируются автоматически

## Техническая поддержка

- **Версия MCP протокола** - 2024-11-05
- **Версия Spring AI** - 1.0.0
- **Минимальная версия Java** - 17
- **Поддерживаемые ОС** - Linux, macOS, Windows

### Полезные ссылки
- [Репозиторий проекта](https://github.com/alkoleft/mcp-bsl-context)
- [GitHub Container Registry](https://github.com/alkoleft/mcp-bsl-context/pkgs/container/mcp-bsl-context)
- [Релизы](https://github.com/alkoleft/mcp-bsl-context/releases)

Для сообщения об ошибках создайте issue в репозитории проекта.